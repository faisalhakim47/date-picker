{"version":3,"file":"date-picker.js","sources":["events/calendar-view-change-event.js","events/date-related-event.js","events/selected-date-change-event.js","events/selected-date-set-event.js","events/selection-mode-set-event.js","events/year-month-view-change-event.js","tools/date.js","tools/dom.js","elements/context-aware.js","events/picked-date-set-event.js","elements/date-picker-control.js","elements/date-picker-view.js","components/f-date-picker-view.js","elements/date-picker-inline.js","components/f-date-picker-inline.js","elements/date-picker-month-view.js","components/f-date-picker-month-view.js","elements/date-picker-year-view.js","components/f-date-picker-year-view.js","events/picked-date-change-event.js","elements/date-picker-dialog.js","components/f-date-picker-dialog.js"],"sourcesContent":["// @ts-check\n/**\n * @typedef {object} CalendarViewChangeEventDetail\n */\n/**\n * @extends {CustomEvent<CalendarViewChangeEventDetail>}\n */\nexport class CalendarViewChangeEvent extends CustomEvent {\n    static get EVENT_TYPE() {\n        return 'calendar-view-change';\n    }\n    /**\n     * @param {CustomEventInit<CalendarViewChangeEventDetail>} [options]\n     */\n    constructor(options) {\n        super(CalendarViewChangeEvent.EVENT_TYPE, options);\n    }\n}\n//# sourceMappingURL=calendar-view-change-event.js.map","// @ts-check\n/** @typedef {import('../tools/date.js').DateRange} DateRange */\n/** @typedef {DateRange} DateRelatedEventDetail */\n/**\n * @extends {CustomEvent<DateRelatedEventDetail>}\n */\nexport class DateRelatedEvent extends CustomEvent {\n    /** @type {Date} */\n    #beginDate;\n    /** @type {Date} */\n    #endDate;\n    /**\n     * @param {string} type\n     * @param {DateRange} dateRange\n     * @param {CustomEventInit<DateRelatedEventDetail>} [options]\n     */\n    constructor(type, dateRange, options) {\n        super(type, {\n            ...options,\n            detail: {\n                ...options?.detail,\n                ...dateRange,\n            },\n        });\n        this.#beginDate = dateRange.beginDate;\n        this.#endDate = dateRange.endDate;\n    }\n    get beginDate() {\n        return this.#beginDate;\n    }\n    get endDate() {\n        return this.#endDate;\n    }\n}\n//# sourceMappingURL=date-related-event.js.map","// @ts-check\nimport { DateRelatedEvent } from './date-related-event.js';\n/** @typedef {import('../tools/date.js').DateRange} DateRange */\n/** @typedef {import('./date-related-event.js').DateRelatedEventDetail} DateRelatedEventDetail */\nexport class SelectedDateChangeEvent extends DateRelatedEvent {\n    static get EVENT_TYPE() {\n        return 'selected-date-change';\n    }\n    /**\n     * @param {DateRange} dateRange\n     * @param {CustomEventInit<DateRelatedEventDetail>} [options]\n     */\n    constructor(dateRange, options) {\n        super(SelectedDateChangeEvent.EVENT_TYPE, dateRange, options);\n    }\n}\n//# sourceMappingURL=selected-date-change-event.js.map","// @ts-check\nimport { DateRelatedEvent } from './date-related-event.js';\n/** @typedef {import('../tools/date.js').DateRange} DateRange */\n/** @typedef {import('./date-related-event.js').DateRelatedEventDetail} DateRelatedEventDetail */\nexport class SelectedDateSetEvent extends DateRelatedEvent {\n    static get EVENT_TYPE() {\n        return 'selected-date-set';\n    }\n    /**\n     * @param {DateRange} dateRange\n     * @param {CustomEventInit<DateRelatedEventDetail>} [options]\n     */\n    constructor(dateRange, options) {\n        super(SelectedDateSetEvent.EVENT_TYPE, dateRange, options);\n    }\n}\n//# sourceMappingURL=selected-date-set-event.js.map","// @ts-check\n/** @typedef {import('../tools/date.js').DateRange} DateRange */\n/** @typedef {import('./date-related-event.js').DateRelatedEventDetail} DateRelatedEventDetail */\n/** @typedef {'single'|'range'} SelectionMode */\n/**\n * @typedef {object} SelectionModeSetEventDetail\n * @property {SelectionMode} selectionMode\n */\n/**\n * @extends {CustomEvent<SelectionModeSetEventDetail>}\n */\nexport class SelectionModeSetEvent extends CustomEvent {\n    static get EVENT_TYPE() {\n        return 'selection-mode-set';\n    }\n    /** @type {SelectionMode} */\n    #selectionMode;\n    /**\n     * @param {SelectionMode} selectionMode\n     * @param {CustomEventInit<SelectionModeSetEventDetail>} [options]\n     */\n    constructor(selectionMode, options) {\n        super(SelectionModeSetEvent.EVENT_TYPE, {\n            ...options,\n            detail: {\n                ...options?.detail,\n                selectionMode,\n            },\n        });\n        this.#selectionMode = selectionMode;\n    }\n    get selectionMode() {\n        return this.#selectionMode;\n    }\n}\n//# sourceMappingURL=selection-mode-set-event.js.map","// @ts-check\n/**\n * @typedef {object} YearMonthViewChangeEventDetail\n * @property {number} year\n * @property {number} monthIndex\n * @property {string} monthLabel\n */\n/**\n * @extends {CustomEvent<YearMonthViewChangeEventDetail>}\n */\nexport class YearMonthViewChangeEvent extends CustomEvent {\n    static get EVENT_TYPE() {\n        return 'year-month-view-change';\n    }\n    /** @type {number} */\n    #year;\n    /** @type {number} */\n    #monthIndex;\n    /**\n     * @param {number} year\n     * @param {number} monthIndex\n     * @param {string} monthLabel\n     * @param {CustomEventInit<YearMonthViewChangeEventDetail>} [options]\n     */\n    constructor(year, monthIndex, monthLabel, options) {\n        super(YearMonthViewChangeEvent.EVENT_TYPE, {\n            ...options,\n            detail: {\n                ...options?.detail,\n                year,\n                monthIndex,\n                monthLabel,\n            },\n        });\n        this.#year = year;\n        this.#monthIndex = monthIndex;\n    }\n    get year() {\n        return this.#year;\n    }\n    get monthIndex() {\n        return this.#monthIndex;\n    }\n}\n//# sourceMappingURL=year-month-view-change-event.js.map","// @ts-check\n/** @typedef {Date|number|string} AnyDate */\n/**\n * @typedef {object} DateRange\n * @property {Date} beginDate\n * @property {Date} endDate\n */\n/**\n * @param {DateRange} dateRange\n * @returns {string}\n */\nexport function dateRangeToString({ beginDate, endDate }) {\n    if (isInvalidDate(beginDate) || isInvalidDate(endDate)) {\n        return '';\n    }\n    const beginDateString = dateToString(beginDate);\n    const endDateString = dateToString(endDate);\n    return `${beginDateString}/${endDateString}`;\n}\n/**\n * @param {Date} date\n * @returns {string}\n */\nexport function dateToString(date) {\n    if (isInvalidDate(date)) {\n        return '';\n    }\n    const fullIsoString = date.toISOString();\n    const dateIsoString = fullIsoString.split('T')[0];\n    return dateIsoString;\n}\n/**\n * @param {AnyDate} [anyDate]\n * @returns {boolean}\n */\nexport function isInvalidDate(anyDate) {\n    if (!anyDate) {\n        return true;\n    }\n    const date = new Date(anyDate);\n    return date === null || isNaN(date.getTime());\n}\n/**\n * @param {string} dateRangeString\n * @returns {DateRange}\n */\nexport function dateRangeStringToDateRange(dateRangeString) {\n    const [beginDateString, endDateString] = dateRangeString.split('/');\n    const beginDate = new Date(beginDateString);\n    const endDate = new Date(endDateString);\n    return {\n        beginDate: isInvalidDate(beginDate) ? null : beginDate,\n        endDate: isInvalidDate(endDate) ? null : endDate,\n    };\n}\n/**\n * @param {Date} date\n * @returns {number}\n */\nexport function dateToNumber(date) {\n    if (isInvalidDate(date)) {\n        return 0;\n    }\n    const dateString = dateToString(date);\n    return parseInt(dateString.replace(/-/g, ''), 10);\n}\n/**\n * @param {string} dateString\n * @returns {Date}\n */\nexport function dateStringToDate(dateString) {\n    const [yearStr, monthStr, rawDateStr] = dateString.split('-');\n    const dateStr = (rawDateStr || '')\n        .split('T')[0]\n        .split(' ')[0];\n    const year = parseInt(yearStr, 10);\n    const month = parseInt(monthStr, 10);\n    const date = parseInt(dateStr, 10);\n    return new Date(year, month - 1, date);\n}\n//# sourceMappingURL=date.js.map","// @ts-check\n/**\n * @typedef {Node|Attr|string} BasicProp\n */\n/**\n * @template {keyof HTMLElementTagNameMap} TagName\n * @typedef {(element: HTMLElementTagNameMap[TagName]) => void} FnProp\n */\n/**\n * @template {keyof HTMLElementTagNameMap} TagName\n * @typedef {BasicProp|FnProp<TagName>|void} Prop\n */\n// let padding = 0;\n/**\n * @template {keyof HTMLElementTagNameMap} TagName\n * @template {HTMLElementTagNameMap[TagName]} Elm\n * @param {TagName|Elm} tagNameOrElement\n * @param {(element: HTMLElementTagNameMap[TagName]|Elm) => Array<Prop<TagName>>} propFn\n * @returns {HTMLElementTagNameMap[TagName]|Elm}\n */\nexport function el(tagNameOrElement, propFn) {\n    // console.log(`${' '.repeat(padding)}<${tagNameOrElement}>`);\n    // padding += 2;\n    /** @type {HTMLElementTagNameMap[TagName]|Elm} */\n    const element = (typeof tagNameOrElement === 'string')\n        ? document.createElement(tagNameOrElement)\n        : tagNameOrElement;\n    const props = propFn(element);\n    for (const prop of props) {\n        if (prop instanceof Attr) {\n            element.setAttributeNode(prop);\n        }\n        else if (prop instanceof Node) {\n            element.appendChild(prop);\n        }\n        else if (typeof prop === 'function') {\n            prop(element);\n        }\n        else if (typeof prop === 'string') {\n            const text = document.createTextNode(prop);\n            element.appendChild(text);\n        }\n    }\n    // padding -= 2;\n    // console.log(`${' '.repeat(padding)}</${tagNameOrElement}>`);\n    return element;\n}\n/**\n   * @param {string} localName\n   * @param {string} value\n   * @returns {Attr}\n   */\nexport function at(localName, value) {\n    const attr = document.createAttribute(localName);\n    attr.value = value;\n    return attr;\n}\n/**\n   * @param {string} data\n   * @returns {Text}\n   */\nexport function tx(data) {\n    const text = document.createTextNode(data);\n    return text;\n}\n/**\n   * @template {keyof HTMLElementTagNameMap} TagName\n   * @template {keyof HTMLElementEventMap} EventName\n   * @param {EventName} type\n   * @param {(this: HTMLElementTagNameMap[TagName], event: HTMLElementEventMap[EventName]) => void} listener\n   * @param {boolean|AddEventListenerOptions} [options]\n   * @returns {(element: HTMLElementTagNameMap[TagName]) => void}\n   */\nexport function on(type, listener, options) {\n    return function (element) {\n        /** @type {any} */\n        const bypassTypingListener = listener;\n        element.addEventListener(type, bypassTypingListener, options);\n    };\n}\n//# sourceMappingURL=dom.js.map","// @ts-check\nexport class ContextAwareElement extends HTMLElement {\n    /**\n     * Why is this method async?\n     * this method usually is called in connectedCallback hook of web component\n     * but unfortunately, before connectedCallback is called, the element is not yet attached to the DOM\n     * therefore the parentElement is invalid, and we need to wait for the next tick\n     *\n     * @template {ContextAwareElement} T\n     * @param {new () => T} constructor\n     * @param {number} [checkingInterval]\n     * @returns {Promise<T>}\n     */\n    async requireContext(constructor, checkingInterval = 50) {\n        return new Promise((resolve) => {\n            setTimeout(() => {\n                const context = this.#traceContext(constructor);\n                if (context instanceof constructor) {\n                    resolve(context);\n                }\n                else {\n                    const timeThreshold = 5000;\n                    const retryThreshold = timeThreshold / checkingInterval;\n                    let numOfRetries = 0;\n                    const interval = setInterval(() => {\n                        const context = this.#traceContext(constructor);\n                        if (context instanceof constructor) {\n                            clearInterval(interval);\n                            resolve(context);\n                        }\n                        else if (numOfRetries > retryThreshold) {\n                            clearInterval(interval);\n                            throw new Error(`Failed to find the context of ${constructor.name} after ${retryThreshold * checkingInterval}ms`);\n                        }\n                        else {\n                            numOfRetries++;\n                        }\n                    }, checkingInterval);\n                }\n            });\n        });\n    }\n    /**\n     * @template {ContextAwareElement} T\n     * @param {new () => T} constructor\n     * @returns {T}\n     */\n    #traceContext(constructor) {\n        /** @type {Node} */\n        let element = this;\n        while (element) {\n            if (element instanceof constructor) {\n                return element;\n            }\n            if (element instanceof ShadowRoot) {\n                element = element.host;\n            }\n            else {\n                element = element.parentNode;\n            }\n        }\n        return null;\n    }\n}\n//# sourceMappingURL=context-aware.js.map","// @ts-check\nimport { DateRelatedEvent } from './date-related-event.js';\n/** @typedef {import('../tools/date.js').DateRange} DateRange */\n/** @typedef {import('./date-related-event.js').DateRelatedEventDetail} DateRelatedEventDetail */\nexport class PickedDateSetEvent extends DateRelatedEvent {\n    static get EVENT_TYPE() {\n        return 'picked-date-set';\n    }\n    /**\n     * @param {DateRange} dateRange\n     * @param {CustomEventInit<DateRelatedEventDetail>} [options]\n     */\n    constructor(dateRange, options) {\n        super(PickedDateSetEvent.EVENT_TYPE, dateRange, options);\n    }\n}\n//# sourceMappingURL=picked-date-set-event.js.map","// @ts-check\nimport { PickedDateSetEvent } from '../events/picked-date-set-event.js';\nimport { dateStringToDate, dateToString, isInvalidDate } from '../tools/date.js';\nimport { ContextAwareElement } from './context-aware.js';\n/** @typedef {import('../events/selection-mode-set-event.js').SelectionMode} SelectionMode */\n/**\n * @typedef {'day'} TimeUnit\n */\nexport class DatePickerControlElement extends ContextAwareElement {\n    static get formAssociated() {\n        return true;\n    }\n    /** @type {TimeUnit} */\n    static TIME_UNIT_DAY = 'day';\n    /** @type {SelectionMode} */\n    static SELECTION_MODE_SINGLE = 'single';\n    /** @type {SelectionMode} */\n    static SELECTION_MODE_RANGE = 'range';\n    static #AVAILABLE_TIME_UNITS = [\n        DatePickerControlElement.TIME_UNIT_DAY,\n    ];\n    static #AVAILABLE_SELECTION_MODES = [\n        DatePickerControlElement.SELECTION_MODE_SINGLE,\n        DatePickerControlElement.SELECTION_MODE_RANGE,\n    ];\n    #internals = this.attachInternals();\n    /** @type {TimeUnit} */\n    #timeUnit = 'day';\n    /** @type {SelectionMode} */\n    #selectionMode = 'single';\n    /** @type {Date} */\n    #beginDate;\n    /** @type {Date} */\n    #endDate;\n    connectedCallback() {\n        if (this.hasAttribute('value')) {\n            this.value = this.getAttribute('value');\n        }\n        if (this.hasAttribute('time-unit')) {\n            /** @type {any} */\n            const timeUnit = this.getAttribute('time-unit');\n            this.timeUnit = timeUnit;\n        }\n        if (this.hasAttribute('selection-mode')) {\n            /** @type {any} */\n            const selectionMode = this.getAttribute('selection-mode');\n            this.selectionMode = selectionMode;\n        }\n    }\n    get timeUnit() {\n        return this.#timeUnit;\n    }\n    /**\n     * @param {TimeUnit} timeUnit\n     */\n    set timeUnit(timeUnit) {\n        if (!DatePickerControlElement.#AVAILABLE_TIME_UNITS.includes(timeUnit)) {\n            console.warn('Invalid time unit', timeUnit);\n            return;\n        }\n        this.#timeUnit = timeUnit;\n    }\n    get selectionMode() {\n        return this.#selectionMode;\n    }\n    /**\n     * @param {any} selectionMode\n     */\n    set selectionMode(selectionMode) {\n        if (!DatePickerControlElement.#AVAILABLE_SELECTION_MODES.includes(selectionMode)) {\n            console.warn('Invalid selection mode', selectionMode);\n            return;\n        }\n        this.#selectionMode = selectionMode;\n    }\n    get value() {\n        /** @type {(date: Date) => string} */\n        let dateFormatter = null;\n        if (this.#timeUnit === DatePickerControlElement.TIME_UNIT_DAY) {\n            dateFormatter = dateToString;\n        }\n        else {\n            throw new Error('Invalid time unit');\n        }\n        if (this.#selectionMode === DatePickerControlElement.SELECTION_MODE_RANGE) {\n            return (this.#beginDate instanceof Date && this.#endDate instanceof Date)\n                ? `${dateFormatter(this.#beginDate)}/${dateFormatter(this.#endDate)}`\n                : null;\n        }\n        else if (this.#selectionMode === DatePickerControlElement.SELECTION_MODE_SINGLE) {\n            return this.#beginDate instanceof Date\n                ? dateFormatter(this.#beginDate)\n                : null;\n        }\n        else {\n            throw new Error('Invalid selection mode');\n        }\n    }\n    /**\n     * @param {string} value\n     */\n    set value(value) {\n        if (!value) {\n            this.#beginDate = null;\n            this.#endDate = null;\n            this.#internals.setFormValue(null);\n            this.removeAttribute('value');\n            this.dispatchEvent(new PickedDateSetEvent({\n                beginDate: null,\n                endDate: null,\n            }));\n            return;\n        }\n        /** @type {(dateStr: string) => Date} */\n        let dateParserFn = null;\n        if (this.#timeUnit === DatePickerControlElement.TIME_UNIT_DAY) {\n            dateParserFn = dateStringToDate;\n        }\n        else {\n            throw new Error('Invalid time unit');\n        }\n        if (this.#selectionMode === DatePickerControlElement.SELECTION_MODE_RANGE) {\n            if (!value?.includes('/')) {\n                console.warn('Invalid date range format', value);\n                return;\n            }\n            const [beginDateStr, endDateStr] = value.split('/');\n            const beginDate = dateParserFn(beginDateStr);\n            const endDate = dateParserFn(endDateStr);\n            if (isInvalidDate(beginDate)) {\n                this.#beginDate = null;\n                this.#endDate = null;\n                this.#internals.setFormValue(null);\n                this.removeAttribute('value');\n                this.dispatchEvent(new PickedDateSetEvent({\n                    beginDate: null,\n                    endDate: null,\n                }));\n            }\n            else {\n                this.#beginDate = beginDate;\n                if (isInvalidDate(endDate)) {\n                    this.#endDate = null;\n                    this.#internals.setFormValue(beginDateStr);\n                    this.dispatchEvent(new PickedDateSetEvent({\n                        beginDate,\n                        endDate: null,\n                    }));\n                }\n                else {\n                    this.#endDate = endDate;\n                    this.#internals.setFormValue(`${beginDateStr}/${endDateStr}`);\n                    this.dispatchEvent(new PickedDateSetEvent({\n                        beginDate,\n                        endDate,\n                    }));\n                }\n            }\n        }\n        else if (this.#selectionMode === DatePickerControlElement.SELECTION_MODE_SINGLE) {\n            const date = dateParserFn(value);\n            if (isInvalidDate(date)) {\n                this.#beginDate = null;\n                this.#internals.setFormValue(null);\n                this.removeAttribute('value');\n                this.dispatchEvent(new PickedDateSetEvent({\n                    beginDate: null,\n                    endDate: null,\n                }));\n            }\n            else {\n                this.#beginDate = date;\n                this.#internals.setFormValue(dateToString(date));\n                this.dispatchEvent(new PickedDateSetEvent({\n                    beginDate: date,\n                    endDate: null,\n                }));\n            }\n        }\n        else {\n            throw new Error('Invalid selection mode');\n        }\n        const [beginDateStr, endDateStr] = (value ?? '').split('/');\n        const beginDate = beginDateStr\n            ? new Date(beginDateStr)\n            : new Date(Infinity);\n        const endDate = endDateStr\n            ? new Date(endDateStr)\n            : new Date(Infinity);\n        const isInvalidBeginDate = isInvalidDate(beginDate);\n        const isInvalidEndDate = isInvalidDate(endDate);\n        if (isInvalidBeginDate) {\n            this.#beginDate = null;\n            this.#endDate = null;\n            this.#internals.setFormValue(null);\n            this.removeAttribute('value');\n            this.dispatchEvent(new PickedDateSetEvent({\n                beginDate: null,\n                endDate: null,\n            }));\n        }\n        else {\n            const beginDateStr = dateToString(beginDate);\n            this.#beginDate = beginDate;\n            if (isInvalidEndDate) {\n                this.#endDate = null;\n                this.#internals.setFormValue(beginDateStr);\n                this.dispatchEvent(new PickedDateSetEvent({\n                    beginDate,\n                    endDate: null,\n                }));\n            }\n            else {\n                const endDateStr = dateToString(endDate);\n                this.#endDate = endDate;\n                this.#internals.setFormValue(`${beginDateStr}/${endDateStr}`);\n                this.dispatchEvent(new PickedDateSetEvent({\n                    beginDate,\n                    endDate,\n                }));\n            }\n        }\n    }\n    get beginDateValue() {\n        return this.#beginDate instanceof Date\n            ? new Date(this.#beginDate)\n            : null;\n    }\n    get endDateValue() {\n        return this.#endDate instanceof Date\n            ? new Date(this.#endDate)\n            : null;\n    }\n    get form() {\n        return this.#internals.form;\n    }\n    get name() {\n        return this.attributes.getNamedItem('name')?.nodeValue;\n    }\n    get type() {\n        return this.localName;\n    }\n    get validity() {\n        return this.#internals.validity;\n    }\n    get validationMessage() {\n        return this.#internals.validationMessage;\n    }\n    get willValidate() {\n        return this.#internals.willValidate;\n    }\n    checkValidity() {\n        return this.#internals.checkValidity();\n    }\n    reportValidity() {\n        return this.#internals.reportValidity();\n    }\n}\n//# sourceMappingURL=date-picker-control.js.map","// @ts-check\nvar _a;\nimport { CalendarViewChangeEvent } from '../events/calendar-view-change-event.js';\nimport { SelectedDateChangeEvent } from '../events/selected-date-change-event.js';\nimport { SelectedDateSetEvent } from '../events/selected-date-set-event.js';\nimport { SelectionModeSetEvent } from '../events/selection-mode-set-event.js';\nimport { YearMonthViewChangeEvent } from '../events/year-month-view-change-event.js';\nimport { dateToNumber, dateToString, isInvalidDate } from '../tools/date.js';\nimport { at, el, on, tx } from '../tools/dom.js';\nimport { ContextAwareElement } from './context-aware.js';\nimport { DatePickerControlElement } from './date-picker-control.js';\n/** @typedef {import('./date-picker-control.js').SelectionMode} SelectionMode */\nexport class DatePickerViewElement extends ContextAwareElement {\n    static #ID_INC = 0;\n    static #STYLES = (function () {\n        const style = new CSSStyleSheet();\n        style.replace(`\n:host {\n  --si-width: 336px;\n  --si-calendar-label-margin: 8px;\n  --si-calendar-label-text-color: dimgray;\n  --si-cell-size: calc(var(--si-width) / 7);\n  --si-cell-width: var(--si-cell-size);\n  --si-cell-height: var(--si-cell-size);\n  --si-cell-bg-color: white;\n  --si-cell-text-color: black;\n  --si-cell-font-weight: normal;\n  --si-cell-selected-bg-color: aliceblue;\n  --si-cell-selected-text-color: black;\n  --si-cell-selected-font-weight: bold;\n  --si-cell-weekend-text-color: red;\n  --si-cell-other-month-text-color: silver;\n  --si-cell-other-month-weekend-text-color: tomato;\n  --si-cell-font-size: 16px;\n  --si-inner-cell-selected-bg-color: lightblue;\n  --si-inner-cell-padding: 10px;\n  --si-inner-cell-size: min(\n    calc(var(--si-cell-width) - var(--si-inner-cell-padding)),\n    calc(var(--si-cell-height) - var(--si-inner-cell-padding))\n  );\n  --si-header-height: calc(var(--si-cell-size) - 4px);\n  --si-section-height: calc(\n      var(--si-header-height)\n      + var(--si-calendar-label-margin)\n      + var(--si-header-height)\n      + var(--si-calendar-label-margin)\n      + var(--si-cell-height)\n      + var(--si-cell-height)\n      + var(--si-cell-height)\n      + var(--si-cell-height)\n      + var(--si-cell-height)\n      + var(--si-cell-height)\n  );\n  --si-section-width: var(--si-width);\n  display: block;\n  font-family: sans-serif;\n  width: var(--si-width);\n  height: var(--si-section-height);\n}\n\n.sr-only {\n  display: none;\n  visibility: hidden;\n}\n\nsection {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: var(--si-section-width);\n  height: var(--si-section-height);\n}\n\nsection > header {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  height: var(--si-header-height);\n}\n\nsection > header > .year-month-pagination {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\nsection > header > .year-month-pagination > button {\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  width: var(--si-cell-size);\n  height: var(--si-header-height);\n  margin: 0;\n  padding: 0;\n  border: var(--si-button-border, 1px solid none);\n  background-color: var(--si-button-bg-color, none);\n}\n\nsection select[name=\"month\"] {\n  box-sizing: border-box;\n  height: var(--si-header-height);\n  padding: 0 8px;\n}\n\nsection input[name=\"year\"] {\n  box-sizing: border-box;\n  display: block;\n  width: 96px;\n  height: var(--si-header-height);\n  padding: 0 8px;\n}\n\nsection > table {\n  border-collapse: collapse;\n  border-spacing: 0;\n  width: var(--si-width);\n}\n\nsection > table,\nsection > table > thead > tr > th,\nsection > table > tbody > tr > td {\n  border: none;\n}\n\nsection > table > thead > tr > th,\nsection > table > thead > tr > th > span,\nsection > table > tbody > tr > td,\nsection > table > tbody > tr > td > label {\n  box-sizing: border-box;\n  width: var(--si-cell-width);\n  height: var(--si-cell-height);\n  padding: 0;\n  margin: 0;\n  font-size: var(--si-cell-font-size);\n}\n\nsection > table > thead > tr > th > span {\n  -webkit-user-select: none;\n  user-select: none;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  line-height: 1;\n  margin-top: var(--si-calendar-label-margin);\n  margin-bottom: var(--si-calendar-label-margin);\n  font-weight: normal;\n  color: var(--si-calendar-label-text-color);\n}\n\nsection > table > tbody > tr > td > label {\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n}\n\nsection > table > tbody > tr > td > label.range-selected {\n  background-color: var(--si-cell-selected-bg-color);\n}\n\nsection > table > tbody > tr > td > label.range-selected-first {\n  border-top-left-radius: 50%;\n  border-bottom-left-radius: 50%;\n}\n\nsection > table > tbody > tr > td > label.range-selected-last {\n  border-top-right-radius: 50%;\n  border-bottom-right-radius: 50%;\n}\n\nsection > table > tbody > tr > td > label > input {\n  display: none;\n  visibility: hidden;\n}\n\nsection > table > tbody > tr > td > label > span {\n  -webkit-user-select: none;\n  user-select: none;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  width: var(--si-inner-cell-size);\n  height: var(--si-inner-cell-size);\n  border-radius: 50%;\n}\n\nsection > table > tbody > tr > td > label > span > span {\n  display: block;\n  padding: 0;\n  margin: 0;\n  font-variant-numeric: normal;\n  line-height: 1;\n}\n\nsection > table > tbody > tr > td > label:has(input:checked) > span {\n  background-color: var(--si-inner-cell-selected-bg-color);\n}\n\nsection > table > tbody > tr > td > label:has(input:checked) > span > span {\n  color: var(--si-cell-selected-text-color, white);\n  font-weight: var(--si-cell-selected-font-weight, bold);\n}\n\nsection > table > tbody > tr > td > label.weekend > span > span {\n  color: var(--si-cell-weekend-text-color);\n}\n\nsection > table > tbody > tr > td > label.other-month > span > span {\n  color: var(--si-cell-other-month-text-color);\n}\n\nsection > table > tbody > tr > td > label.other-month.weekend > span > span {\n  color: var(--si-cell-other-month-weekend-text-color);\n}\n    `);\n        return [\n            style,\n        ];\n    })();\n    static get observedAttributes() {\n        return [\n            'lang',\n            'timeperiod',\n        ];\n    }\n    #shadowRoot = this.attachShadow({ mode: 'closed' });\n    #idSufix = _a.#ID_INC++;\n    /** @type {HTMLTableSectionElement} */\n    #calendarTbody;\n    /** @type {HTMLInputElement} */\n    #yearInput;\n    /** @type {HTMLSelectElement} */\n    #monthSelect;\n    /** @type {HTMLSlotElement} */\n    #yearMonthControlsSlot;\n    #minYear = 100;\n    #maxYear = 275759;\n    #yearView = 0;\n    #monthIndexView = 0;\n    /** @type {SelectionMode} */\n    #selectionMode = DatePickerControlElement.SELECTION_MODE_SINGLE;\n    /** @type {Date} */\n    #selectedBeginDate;\n    /** @type {Date} */\n    #selectedEndDate;\n    /** @type {(date: Date) => boolean} */\n    #isDateDisabled = (date) => {\n        return false;\n    };\n    async connectedCallback() {\n        this.#shadowRoot.adoptedStyleSheets = _a.#STYLES;\n        this.#render();\n        const controlCtx = await this.requireContext(DatePickerControlElement);\n        const viewCtx = await this.requireContext(_a);\n        this.#selectionMode = controlCtx.selectionMode;\n        this.#selectedBeginDate = controlCtx.beginDateValue;\n        this.#selectedEndDate = controlCtx.endDateValue;\n        controlCtx.addEventListener(SelectedDateSetEvent.EVENT_TYPE, this.#handleSelectedDateSet);\n        controlCtx.addEventListener(SelectionModeSetEvent.EVENT_TYPE, this.#handleSelectionModeSet);\n        viewCtx.addEventListener(CalendarViewChangeEvent.EVENT_TYPE, this.#handleCalendarViewChange);\n        const defaultDate = this.#selectedBeginDate instanceof Date\n            ? this.#selectedBeginDate\n            : new Date();\n        this.#setYearMonthView(defaultDate.getUTCFullYear(), defaultDate.getUTCMonth());\n    }\n    async disconnectedCallback() {\n        const controlCtx = await this.requireContext(DatePickerControlElement);\n        const viewCtx = await this.requireContext(_a);\n        controlCtx.removeEventListener(SelectedDateSetEvent.EVENT_TYPE, this.#handleSelectedDateSet);\n        controlCtx.removeEventListener(SelectionModeSetEvent.EVENT_TYPE, this.#handleSelectionModeSet);\n        viewCtx.removeEventListener(CalendarViewChangeEvent.EVENT_TYPE, this.#handleCalendarViewChange);\n    }\n    get monthNames() {\n        const formatter = new Intl.DateTimeFormat(this.#locale, { month: 'long' });\n        const monthIndexes = [...Array(12).keys()];\n        return monthIndexes.map((monthIndex) => {\n            const date = new Date(2000, monthIndex);\n            return formatter.format(date);\n        });\n    }\n    get dayShortNames() {\n        const formatter = new Intl.DateTimeFormat(this.#locale, { weekday: 'short' });\n        const dayIndexes = [...Array(7).keys()];\n        const firstDayOfWeekDate = new Date(2000, 0, 1);\n        firstDayOfWeekDate.setUTCDate(firstDayOfWeekDate.getUTCDate() - firstDayOfWeekDate.getUTCDay());\n        return dayIndexes.map((dayIndex) => {\n            const date = new Date(firstDayOfWeekDate);\n            date.setUTCDate(date.getUTCDate() + dayIndex);\n            return formatter.format(date);\n        });\n    }\n    get yearView() {\n        return this.#yearView;\n    }\n    get monthIndexView() {\n        return this.#monthIndexView;\n    }\n    /**\n     * @param {Date} [date]\n     */\n    setSelectedBeginDate(date) {\n        if (isInvalidDate(date)) {\n            this.#selectedBeginDate = null;\n        }\n        else {\n            this.#selectedBeginDate = date;\n        }\n        this.#selectedEndDate = null;\n        this.#patchRangeSelection();\n    }\n    /**\n     * @param {Date} [date]\n     */\n    setSelectedEndDate(date) {\n        if (!(this.#selectedBeginDate instanceof Date)) {\n            throw new Error('Begin date must be set first');\n        }\n        if (isInvalidDate(date)) {\n            this.#selectedEndDate = null;\n        }\n        else {\n            if (date.getTime() < this.#selectedBeginDate.getTime()) {\n                this.setSelectedBeginDate(date);\n                return;\n            }\n            this.#selectedEndDate = new Date(date);\n        }\n        this.#patchRangeSelection();\n    }\n    /**\n     * @param {(date: Date) => boolean} filterFn\n     */\n    async setDisabledFilter(filterFn) {\n        this.#isDateDisabled = filterFn;\n        const viewCtx = await this.requireContext(_a);\n        viewCtx.dispatchEvent(new CalendarViewChangeEvent());\n    }\n    /**\n     * @param {number} year\n     * @param {number} monthIndex\n     */\n    async #setYearMonthView(year, monthIndex) {\n        this.#yearView = year;\n        this.#monthIndexView = monthIndex;\n        const monthLabel = this.monthNames[monthIndex];\n        this.#monthSelect.selectedIndex = monthIndex;\n        this.#yearInput.value = year.toString();\n        const viewCtx = await this.requireContext(_a);\n        viewCtx.dispatchEvent(new YearMonthViewChangeEvent(year, monthIndex, monthLabel));\n        viewCtx.dispatchEvent(new CalendarViewChangeEvent());\n    }\n    /**\n     * @param {Event} event\n     */\n    #handleCalendarViewChange = (event) => {\n        if (event instanceof CalendarViewChangeEvent) {\n            const newCalendar = this.#renderCalendar();\n            this.#calendarTbody.replaceWith(newCalendar);\n            this.#calendarTbody = newCalendar;\n            this.#patchRangeSelection();\n        }\n    };\n    get #datesByWeekView() {\n        const year = this.yearView;\n        const monthIndex = this.monthIndexView;\n        const beginOfMonthDate = new Date(year, monthIndex, 1, 0, 0, 0, 0);\n        const beginOfWeekOfMonthDate = new Date(beginOfMonthDate);\n        beginOfWeekOfMonthDate.setUTCDate(beginOfWeekOfMonthDate.getUTCDate() - beginOfWeekOfMonthDate.getUTCDay());\n        const endOfMonthDate = new Date(year, monthIndex + 1, 0, 0, 0, 0, 0);\n        const endOfWeekOfMonthDate = new Date(endOfMonthDate);\n        endOfWeekOfMonthDate.setUTCDate(endOfWeekOfMonthDate.getUTCDate() + (6 - endOfWeekOfMonthDate.getUTCDay()));\n        let date = new Date(beginOfWeekOfMonthDate);\n        const weeksView = [\n            {\n                dates: [\n                    {\n                        date: new Date(date),\n                        isCurrMonth: false,\n                        isPrevMonth: true,\n                        isNextMonth: false,\n                        isToday: false,\n                        isWeekend: false,\n                        isDisabled: false,\n                    },\n                ].slice(0, 0),\n            },\n        ];\n        let dayIndex = 0;\n        const selectedDateIsoString = isInvalidDate(this.#selectedBeginDate) ? null : dateToString(this.#selectedBeginDate);\n        while (date.getTime() <= endOfWeekOfMonthDate.getTime() || weeksView.length <= 6) {\n            const latestWeek = weeksView[weeksView.length - 1];\n            const dateDayIndex = date.getUTCDay();\n            const dateMonthIndex = date.getUTCMonth();\n            const dateYear = date.getUTCFullYear();\n            const yearViewDiff = (dateYear - this.yearView) * 12;\n            const isCurrMonth = (yearViewDiff + dateMonthIndex) === this.monthIndexView;\n            const isPrevMonth = (yearViewDiff + dateMonthIndex) < this.monthIndexView;\n            const isNextMonth = (yearViewDiff + dateMonthIndex) > this.monthIndexView;\n            const isToday = dateToString(date) === selectedDateIsoString;\n            const isWeekend = dateDayIndex === 0 || dateDayIndex === 6;\n            const isDisabled = typeof this.#isDateDisabled === 'function'\n                ? this.#isDateDisabled(date)\n                : false;\n            latestWeek.dates.push({\n                date: new Date(date),\n                numericDate: dateToNumber(date),\n                isCurrMonth,\n                isPrevMonth,\n                isNextMonth,\n                isToday,\n                isWeekend,\n                isDisabled,\n            });\n            date.setUTCDate(date.getUTCDate() + 1);\n            dayIndex++;\n            if (dayIndex === 7) {\n                weeksView.push({\n                    dates: [],\n                });\n                dayIndex = 0;\n            }\n        }\n        return weeksView;\n    }\n    /**\n     * @param {string} name\n     */\n    #id(name) {\n        return `${name}-${this.#idSufix}`;\n    }\n    get #locale() {\n        const locales = this.lang || 'en';\n        return locales;\n    }\n    #viewPrevMonth() {\n        const monthIndex = this.#monthSelect.selectedIndex;\n        const year = parseInt(this.#yearInput.value, 10);\n        const prevMonthIndex = monthIndex - 1;\n        if (prevMonthIndex < 0) {\n            this.#monthSelect.selectedIndex = 11;\n            this.#yearInput.value = (year - 1).toString();\n            this.#setYearMonthView(year - 1, 11);\n        }\n        else {\n            this.#monthSelect.selectedIndex = prevMonthIndex;\n            this.#setYearMonthView(year, prevMonthIndex);\n        }\n    }\n    #viewNextMonth() {\n        const monthIndex = this.#monthSelect.selectedIndex;\n        const year = parseInt(this.#yearInput.value, 10);\n        const nextMonthIndex = monthIndex + 1;\n        if (nextMonthIndex > 11) {\n            this.#monthSelect.selectedIndex = 0;\n            this.#yearInput.value = (year + 1).toString();\n            this.#setYearMonthView(year + 1, 0);\n        }\n        else {\n            this.#monthSelect.selectedIndex = nextMonthIndex;\n            this.#setYearMonthView(year, nextMonthIndex);\n        }\n    }\n    /**\n     * @param {Date} date\n     */\n    async #handleDateSelect(date) {\n        if (this.#selectionMode === DatePickerControlElement.SELECTION_MODE_SINGLE) {\n            if (this.#selectedBeginDate instanceof Date) {\n                if (this.#selectedBeginDate.getTime() === date.getTime()) {\n                    this.setSelectedBeginDate(null);\n                }\n                else {\n                    this.setSelectedBeginDate(date);\n                }\n            }\n            else {\n                this.setSelectedBeginDate(date);\n            }\n        }\n        else if (this.#selectionMode === DatePickerControlElement.SELECTION_MODE_RANGE) {\n            if (this.#selectedBeginDate instanceof Date) {\n                if (date.getTime() < this.#selectedBeginDate.getTime()) {\n                    this.setSelectedBeginDate(date);\n                }\n                else {\n                    if (this.#selectedBeginDate.getTime() === date.getTime()) {\n                        this.setSelectedBeginDate(null);\n                    }\n                    else {\n                        /**\n                         * What happens when begin date and end date has been set?\n                         */\n                        if (this.#selectedEndDate instanceof Date) {\n                            /**\n                             * USE CASE 1: Reset\n                             */\n                            this.setSelectedBeginDate(date);\n                            /**\n                             * USE CASE 2: Set end date\n                             */\n                            // if (date.getTime() === this.#selectedEndDate.getTime()) {\n                            //   this.setSelectedEndDate(null);\n                            // }\n                            // else {\n                            //   this.setSelectedEndDate(date);\n                            // }\n                        }\n                        else {\n                            this.setSelectedEndDate(date);\n                        }\n                    }\n                }\n            }\n            else {\n                this.setSelectedBeginDate(date);\n            }\n        }\n        else {\n            throw new Error('Invalid selection mode: ' + this.#selectionMode);\n        }\n        const controlCtx = await this.requireContext(DatePickerControlElement);\n        controlCtx.dispatchEvent(new SelectedDateChangeEvent({\n            beginDate: this.#selectedBeginDate,\n            endDate: this.#selectedEndDate,\n        }));\n    }\n    /**\n     * @param {Event} event\n     */\n    #handleSelectionModeSet = (event) => {\n        if (event instanceof SelectionModeSetEvent) {\n            this.#selectionMode = event.detail.selectionMode;\n            this.setSelectedEndDate(null);\n        }\n    };\n    /**\n     * @param {Event} event\n     */\n    #handleSelectedDateSet = (event) => {\n        if (event instanceof SelectedDateSetEvent) {\n            this.#selectedBeginDate = event.detail.beginDate;\n            this.#selectedEndDate = event.detail.endDate;\n            this.#patchRangeSelection();\n        }\n    };\n    #render() {\n        this.#shadowRoot.appendChild(el('section', () => [\n            el('header', () => [\n                this.#yearMonthControlsSlot = el('slot', () => [\n                    at('name', 'year-month-controls'),\n                    el('label', () => [\n                        at('class', 'sr-only'),\n                        at('for', this.#id('month-select')),\n                        tx('Month'),\n                    ]),\n                    this.#monthSelect = el('select', () => [\n                        at('id', this.#id('month-select')),\n                        at('name', 'month'),\n                        at('aria-label', 'Month'),\n                        on('change', (event) => {\n                            event.preventDefault();\n                            const monthIndex = this.#monthSelect.selectedIndex;\n                            const year = parseInt(this.#yearInput.value, 10);\n                            this.#setYearMonthView(year, monthIndex);\n                        }),\n                        ...this.monthNames.map((monthName, index) => {\n                            return el('option', () => [\n                                at('value', monthName),\n                                ...(index === this.monthIndexView ? [at('selected', 'selected')] : []),\n                                tx(monthName),\n                            ]);\n                        }),\n                    ]),\n                    el('label', () => [\n                        at('class', 'sr-only'),\n                        at('for', this.#id('year-input')),\n                        tx('Year'),\n                    ]),\n                    this.#yearInput = el('input', () => [\n                        at('id', this.#id('year-input')),\n                        at('type', 'number'),\n                        at('name', 'year'),\n                        at('aria-label', 'Year'),\n                        at('value', this.yearView.toString()),\n                        at('min', this.#minYear.toString()), // Minimum save year for javascript Date object as of 2024-01-30\n                        at('max', this.#maxYear.toString()), // Maximum save year for javascript Date object as of 2024-01-30\n                        on('change', (event) => {\n                            const monthIndex = this.#monthSelect.selectedIndex;\n                            const year = parseInt(this.#yearInput.value, 10);\n                            if (year < this.#minYear) {\n                                event.preventDefault();\n                                this.#yearInput.setCustomValidity(`Year must be greater than or equal to ${this.#minYear}`);\n                                this.#yearInput.reportValidity();\n                            }\n                            else if (year > this.#maxYear) {\n                                event.preventDefault();\n                                this.#yearInput.setCustomValidity(`Year must be less than or equal to ${this.#maxYear}`);\n                                this.#yearInput.reportValidity();\n                            }\n                            this.#setYearMonthView(year, monthIndex);\n                        }),\n                    ]),\n                ]),\n                el('div', () => [\n                    at('class', 'year-month-pagination'),\n                    el('button', () => [\n                        at('type', 'button'),\n                        on('click', (event) => {\n                            event.preventDefault();\n                            this.#viewPrevMonth();\n                        }),\n                        el('slot', () => [\n                            at('name', 'prev-icon'),\n                            (slot) => slot.innerHTML = `\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 -960 960 960\" height=\"24\" width=\"24\" title=\"Previous\"><path fill=\"currentColor\" d=\"m432-480 156 156q11 11 11 28t-11 28q-11 11-28 11t-28-11L348-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 28-11t28 11q11 11 11 28t-11 28L432-480Z\"/></svg>\n              `,\n                        ]),\n                    ]),\n                    el('button', () => [\n                        at('type', 'button'),\n                        on('click', (event) => {\n                            event.preventDefault();\n                            this.#viewNextMonth();\n                        }),\n                        el('slot', () => [\n                            at('name', 'next-icon'),\n                            (slot) => slot.innerHTML = `\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 -960 960 960\" height=\"24\" width=\"24\" title=\"Next\"><path fill=\"currentColor\" d=\"M504-480 348-636q-11-11-11-28t11-28q11-11 28-11t28 11l184 184q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L404-268q-11 11-28 11t-28-11q-11-11-11-28t11-28l156-156Z\"/></svg>\n              `,\n                        ]),\n                    ]),\n                ]),\n            ]),\n            el('table', () => [\n                el('thead', () => [\n                    el('tr', () => [\n                        ...this.dayShortNames.map((dayShortName) => {\n                            return el('th', () => [\n                                el('span', () => [\n                                    tx(dayShortName),\n                                ]),\n                            ]);\n                        }),\n                    ]),\n                ]),\n                this.#calendarTbody = el('tbody', () => []),\n            ]),\n        ]));\n    }\n    #renderCalendar() {\n        return el('tbody', () => [\n            ...this.#datesByWeekView.map((week) => {\n                return el('tr', () => [\n                    ...week.dates.map((date) => {\n                        return el('td', () => [\n                            el('label', () => [\n                                at('class', [\n                                    ...(date.isWeekend ? ['weekend'] : []),\n                                    ...(date.isCurrMonth ? [] : ['other-month']),\n                                ].join(' ')),\n                                el('input', () => [\n                                    at('type', 'checkbox'),\n                                    at('name', 'date'),\n                                    at('value', date.date.toISOString()),\n                                    ...(date.isDisabled ? [at('disabled', 'disabled')] : []),\n                                    ...(date.isToday ? [at('checked', 'checked')] : []),\n                                    on('change', (event) => {\n                                        try {\n                                            this.#handleDateSelect(date.date);\n                                            if (date.isPrevMonth) {\n                                                this.#viewPrevMonth();\n                                            }\n                                            else if (date.isNextMonth) {\n                                                this.#viewNextMonth();\n                                            }\n                                        }\n                                        catch (error) {\n                                            event.preventDefault();\n                                            throw error;\n                                        }\n                                    }),\n                                ]),\n                                el('span', () => [\n                                    el('span', () => [\n                                        tx(date.date.getUTCDate().toString().padStart(2, '0')),\n                                    ]),\n                                ]),\n                            ]),\n                        ]);\n                    }),\n                ]);\n            }),\n        ]);\n    }\n    #patchRangeSelection() {\n        if (!(this.#calendarTbody instanceof HTMLTableSectionElement)) {\n            return;\n        }\n        const beginDate = this.#selectedBeginDate;\n        const endDate = this.#selectedEndDate;\n        const beginNumericDate = dateToNumber(beginDate);\n        const endNumericDate = dateToNumber(endDate);\n        const isSingleSelect = this.#selectionMode === DatePickerControlElement.SELECTION_MODE_SINGLE;\n        const treeWalker = document.createTreeWalker(this.#calendarTbody, NodeFilter.SHOW_ELEMENT, {\n            acceptNode(node) {\n                return (node instanceof HTMLInputElement && node.name === 'date')\n                    ? NodeFilter.FILTER_ACCEPT\n                    : NodeFilter.FILTER_SKIP;\n            },\n        });\n        let input = treeWalker.currentNode;\n        while (input instanceof Node) {\n            input = treeWalker.nextNode();\n            if (!(input instanceof HTMLInputElement)) {\n                continue;\n            }\n            const label = input.labels.item(0);\n            if (!(label instanceof HTMLLabelElement)) {\n                continue;\n            }\n            // Reset label state\n            label.classList.remove('range-selected');\n            label.classList.remove('range-selected-first');\n            label.classList.remove('range-selected-last');\n            const date = new Date(input.value);\n            const numericDate = dateToNumber(date);\n            const isFirst = numericDate === beginNumericDate;\n            const isLast = numericDate === endNumericDate;\n            if (isFirst || isLast) {\n                input.checked = true;\n                input.setAttribute('checked', 'checked');\n            }\n            else {\n                input.checked = false;\n                input.removeAttribute('checked');\n            }\n            if (isSingleSelect) {\n                continue;\n            }\n            const isInRange = true\n                && (numericDate >= beginNumericDate)\n                && (numericDate <= endNumericDate);\n            if (isInRange) {\n                label.classList.add('range-selected');\n            }\n            if (isFirst) {\n                label.classList.add('range-selected-first');\n            }\n            else if (isLast) {\n                label.classList.add('range-selected-last');\n            }\n        }\n    }\n}\n_a = DatePickerViewElement;\n//# sourceMappingURL=date-picker-view.js.map","// @ts-check\nimport { DatePickerViewElement } from '../elements/date-picker-view.js';\ncustomElements.define('f-date-picker-view', DatePickerViewElement);\n//# sourceMappingURL=f-date-picker-view.js.map","// @ts-check\nimport '../components/f-date-picker-view.js';\nimport { PickedDateSetEvent } from '../events/picked-date-set-event.js';\nimport { SelectionModeSetEvent } from '../events/selection-mode-set-event.js';\nimport { at, el } from '../tools/dom.js';\nimport { DatePickerControlElement } from './date-picker-control.js';\nexport class DatePickerInlineElement extends DatePickerControlElement {\n    static #STYLES = (function () {\n        const style = new CSSStyleSheet();\n        style.replace(`\n    `);\n        return [style];\n    })();\n    static get formAssociated() {\n        return true;\n    }\n    static get observedAttributes() {\n        return [\n            'value',\n            'time-unit',\n            'selection-mode',\n        ];\n    }\n    #shadowRoot = this.attachShadow({ mode: 'closed' });\n    connectedCallback() {\n        super.connectedCallback();\n        this.#shadowRoot.adoptedStyleSheets = DatePickerInlineElement.#STYLES;\n        this.#render();\n    }\n    /**\n     * @param {string} name\n     * @param {string} oldValue\n     * @param {any} newValue\n     */\n    async attributeChangedCallback(name, oldValue, newValue) {\n        if (name === 'value') {\n            this.value = newValue;\n            const controlCtx = await this.requireContext(DatePickerControlElement);\n            controlCtx.dispatchEvent(new PickedDateSetEvent({\n                beginDate: this.beginDateValue,\n                endDate: this.endDateValue,\n            }));\n        }\n        else if (name === 'time-unit') {\n            this.timeUnit = newValue;\n        }\n        else if (name === 'selection-mode') {\n            this.selectionMode = newValue;\n            const controlCtx = await this.requireContext(DatePickerControlElement);\n            controlCtx.dispatchEvent(new SelectionModeSetEvent(this.selectionMode));\n        }\n    }\n    #render() {\n        this.#shadowRoot.appendChild(el('slot', () => [\n            at('name', 'date-picker-view'),\n            el('f-date-picker-view', () => []),\n        ]));\n    }\n}\n//# sourceMappingURL=date-picker-inline.js.map","// @ts-check\nimport { DatePickerInlineElement } from '../elements/date-picker-inline.js';\ncustomElements.define('f-date-picker-inline', DatePickerInlineElement);\n//# sourceMappingURL=f-date-picker-inline.js.map","// @ts-check\nimport { YearMonthViewChangeEvent } from '../events/year-month-view-change-event.js';\nimport { tx } from '../tools/dom.js';\nimport { ContextAwareElement } from './context-aware.js';\nimport { DatePickerViewElement } from './date-picker-view.js';\nexport class DatePickerMonthViewElement extends ContextAwareElement {\n    #shadowRoot = this.attachShadow({ mode: 'closed' });\n    /** @type {Text} */\n    #text;\n    async connectedCallback() {\n        this.#render();\n        const viewCtx = await this.requireContext(DatePickerViewElement);\n        viewCtx.addEventListener(YearMonthViewChangeEvent.EVENT_TYPE, this.#handleMonthViewChange);\n        this.#text.nodeValue = viewCtx.monthNames[viewCtx.monthIndexView];\n    }\n    async disconnectedCallback() {\n        const viewCtx = await this.requireContext(DatePickerViewElement);\n        viewCtx.removeEventListener(YearMonthViewChangeEvent.EVENT_TYPE, this.#handleMonthViewChange);\n    }\n    /**\n     * @param {Event} event\n     */\n    #handleMonthViewChange = (event) => {\n        if (event instanceof YearMonthViewChangeEvent) {\n            this.#text.nodeValue = event.detail.monthLabel.toString();\n        }\n    };\n    #render() {\n        this.#shadowRoot.appendChild(this.#text = tx(''));\n    }\n}\n//# sourceMappingURL=date-picker-month-view.js.map","// @ts-check\nimport { DatePickerMonthViewElement } from '../elements/date-picker-month-view.js';\ncustomElements.define('f-date-picker-month-view', DatePickerMonthViewElement);\n//# sourceMappingURL=f-date-picker-month-view.js.map","// @ts-check\nimport { YearMonthViewChangeEvent } from '../events/year-month-view-change-event.js';\nimport { tx } from '../tools/dom.js';\nimport { ContextAwareElement } from './context-aware.js';\nimport { DatePickerViewElement } from './date-picker-view.js';\nexport class DatePickerYearViewElement extends ContextAwareElement {\n    static get requiredContexts() {\n        return [\n            DatePickerViewElement,\n        ];\n    }\n    #shadowRoot = this.attachShadow({ mode: 'closed' });\n    /** @type {Text} */\n    #text;\n    async connectedCallback() {\n        this.#render();\n        const viewCtx = await this.requireContext(DatePickerViewElement);\n        viewCtx.addEventListener(YearMonthViewChangeEvent.EVENT_TYPE, this.#handleChange);\n    }\n    async disconnectedCallback() {\n        const viewCtx = await this.requireContext(DatePickerViewElement);\n        viewCtx.removeEventListener(YearMonthViewChangeEvent.EVENT_TYPE, this.#handleChange);\n        this.#text.nodeValue = viewCtx.yearView?.toString();\n    }\n    /**\n     * @param {CustomEvent} event\n     */\n    #handleChange = (event) => {\n        if (event instanceof YearMonthViewChangeEvent) {\n            this.#text.nodeValue = event.detail.year.toString();\n        }\n    };\n    #render() {\n        this.#shadowRoot.appendChild(this.#text = tx(''));\n    }\n}\n//# sourceMappingURL=date-picker-year-view.js.map","// @ts-check\nimport { DatePickerYearViewElement } from '../elements/date-picker-year-view.js';\ncustomElements.define('f-date-picker-year-view', DatePickerYearViewElement);\n//# sourceMappingURL=f-date-picker-year-view.js.map","// @ts-check\nimport { DateRelatedEvent } from './date-related-event.js';\n/** @typedef {import('../tools/date.js').DateRange} DateRange */\n/** @typedef {import('./date-related-event.js').DateRelatedEventDetail} DateRelatedEventDetail */\nexport class PickedDateChangeEvent extends DateRelatedEvent {\n    static get EVENT_TYPE() {\n        return 'change';\n    }\n    /**\n     * @param {DateRange} dateRange\n     * @param {CustomEventInit<DateRelatedEventDetail>} [options]\n     */\n    constructor(dateRange, options) {\n        super(PickedDateChangeEvent.EVENT_TYPE, dateRange, options);\n    }\n}\n//# sourceMappingURL=picked-date-change-event.js.map","// @ts-check\nimport '../components/f-date-picker-view.js';\nimport { PickedDateChangeEvent } from '../events/picked-date-change-event.js';\nimport { PickedDateSetEvent } from '../events/picked-date-set-event.js';\nimport { SelectedDateChangeEvent } from '../events/selected-date-change-event.js';\nimport { SelectedDateSetEvent } from '../events/selected-date-set-event.js';\nimport { dateRangeToString, dateToString } from '../tools/date.js';\nimport { at, el, on, tx } from '../tools/dom.js';\nimport { DatePickerControlElement } from './date-picker-control.js';\nexport class DatePickerDialogElement extends DatePickerControlElement {\n    static #STYLES = (function () {\n        const style = new CSSStyleSheet();\n        style.replace(`\n:host {\n  --si-input-button-height: 36px;\n  --si-submit-button-height: 36px;\n  --si-dialog-radius: 4px;\n  --si-dialog-padding: 16px;\n}\nbutton {\n  display: block;\n  padding: 0 8px;\n  height: var(--si-input-button-height);\n}\ndialog {\n  border: none;\n  padding: var(--si-dialog-padding);\n  border-radius: var(--si-dialog-radius);\n}\ndialog > form > slot > div {\n  display: flex;\n  justify-content: flex-end;\n  gap: 8px;\n  margin-top: 8px;\n}\ndialog > form > slot > div > button {\n  display: block;\n  padding: 0 8px;\n  height: var(--si-submit-button-height);\n}\n    `);\n        return [style];\n    })();\n    static get formAssociated() {\n        return true;\n    }\n    static get observedAttributes() {\n        return [\n            'open',\n            'value',\n        ];\n    }\n    #shadowRoot = this.attachShadow({ mode: 'closed' });\n    /** @type {Text} */\n    #buttonText;\n    /** @type {HTMLDialogElement} */\n    #dialog;\n    /** @type {HTMLFormElement} */\n    #form;\n    /** @type {Date} */\n    #selectedBeginDate;\n    /** @type {Date} */\n    #selectedEndDate;\n    async connectedCallback() {\n        const controlCtx = await this.requireContext(DatePickerControlElement);\n        controlCtx.addEventListener(PickedDateChangeEvent.EVENT_TYPE, this.#handlePickedDateChange);\n        controlCtx.addEventListener(PickedDateSetEvent.EVENT_TYPE, this.#handlePickedDateSet);\n        controlCtx.addEventListener(SelectedDateChangeEvent.EVENT_TYPE, this.#handleSelectedDateChange);\n        super.connectedCallback();\n        this.#shadowRoot.adoptedStyleSheets = DatePickerDialogElement.#STYLES;\n        this.#render();\n        this.#dialog.addEventListener('open', this.#handleDialogOpen);\n        this.#dialog.addEventListener('close', this.#handleDialogClose);\n        if (this.hasAttribute('open')) {\n            this.#openDatePicker();\n        }\n        else {\n            this.#closeDatePicker();\n        }\n        this.#updateButtonText();\n    }\n    async disconnectedCallback() {\n        this.#dialog.removeEventListener('open', this.#handleDialogOpen);\n        this.#dialog.removeEventListener('close', this.#handleDialogClose);\n        const controlCtx = await this.requireContext(DatePickerControlElement);\n        controlCtx.removeEventListener(PickedDateChangeEvent.EVENT_TYPE, this.#handlePickedDateChange);\n        controlCtx.removeEventListener(PickedDateSetEvent.EVENT_TYPE, this.#handlePickedDateSet);\n        controlCtx.removeEventListener(SelectedDateChangeEvent.EVENT_TYPE, this.#handleSelectedDateChange);\n    }\n    /**\n     * @param {string} name\n     * @param {string} oldValue\n     * @param {string} newValue\n     */\n    attributeChangedCallback(name, oldValue, newValue) {\n        if (name === 'open') {\n            if (newValue === null) {\n                this.#closeDatePicker();\n            }\n            else {\n                this.#openDatePicker();\n            }\n        }\n        else if (name === 'value') {\n            if (newValue === null) {\n                this.value = null;\n            }\n            else {\n                this.value = newValue;\n            }\n            this.#updateButtonText();\n        }\n    }\n    requestSubmit = () => {\n        this.#form.requestSubmit();\n    };\n    closeDatePicker() {\n        this.#closeDatePicker();\n    }\n    #updateButtonText() {\n        if (this.beginDateValue instanceof Date) {\n            if (this.#buttonText instanceof Text) {\n                this.#buttonText.nodeValue = `Selected Date: ${this.value}`;\n            }\n        }\n        else {\n            if (this.#buttonText instanceof Text) {\n                this.#buttonText.nodeValue = 'Select Date';\n            }\n        }\n    }\n    #openDatePicker = async () => {\n        if (this.#dialog instanceof HTMLDialogElement) {\n            const controlCtx = await this.requireContext(DatePickerControlElement);\n            controlCtx.dispatchEvent(new SelectedDateSetEvent({\n                beginDate: this.#selectedBeginDate,\n                endDate: this.#selectedEndDate,\n            }));\n            this.#dialog.showModal();\n            if (!this.hasAttribute('open')) {\n                this.setAttribute('open', '');\n            }\n        }\n    };\n    #closeDatePicker = () => {\n        if (this.#dialog instanceof HTMLDialogElement) {\n            this.#dialog.close();\n        }\n    };\n    #handleDialogOpen = async () => {\n        if (!this.hasAttribute('open')) {\n            this.setAttribute('open', '');\n        }\n    };\n    #handleDialogClose = () => {\n        if (this.hasAttribute('open')) {\n            this.removeAttribute('open');\n        }\n    };\n    /**\n     * @param {Event} event\n     */\n    #handleSelectedDateChange = (event) => {\n        if (event instanceof SelectedDateChangeEvent) {\n            const { beginDate, endDate } = event.detail;\n            this.#selectedBeginDate = beginDate;\n            this.#selectedEndDate = endDate;\n        }\n    };\n    /**\n     * @param {Event} event\n     */\n    #handlePickedDateChange = (event) => {\n        if (event instanceof PickedDateChangeEvent) {\n            this.#updateButtonText();\n        }\n    };\n    /**\n     * @param {Event} event\n     */\n    #handlePickedDateSet = (event) => {\n        if (event instanceof PickedDateSetEvent) {\n            const { beginDate, endDate } = event.detail;\n            this.#selectedBeginDate = beginDate;\n            this.#selectedEndDate = endDate;\n            this.#updateButtonText();\n        }\n    };\n    #handleFormSubmit = () => {\n        if (this.selectionMode === DatePickerControlElement.SELECTION_MODE_SINGLE) {\n            this.value = dateToString(this.#selectedBeginDate);\n        }\n        else if (this.selectionMode === DatePickerControlElement.SELECTION_MODE_RANGE) {\n            this.value = dateRangeToString({\n                beginDate: this.#selectedBeginDate,\n                endDate: this.#selectedEndDate,\n            });\n        }\n        else {\n            throw new Error('Invalid selection mode');\n        }\n        this.#updateButtonText();\n    };\n    #render() {\n        this.#shadowRoot.appendChild(el('div', () => [\n            el('slot', () => [\n                at('name', 'date-picker-controls'),\n                el('button', () => [\n                    on('click', this.#openDatePicker),\n                    this.#buttonText = tx('Select Date'),\n                ]),\n            ]),\n            this.#dialog = el('dialog', () => [\n                this.#form = el('form', () => [\n                    at('method', 'dialog'),\n                    on('submit', this.#handleFormSubmit),\n                    el('slot', () => [\n                        at('name', 'date-picker-view'),\n                        el('f-date-picker-view', () => []),\n                    ]),\n                    el('slot', () => [\n                        at('name', 'form-controls'),\n                        el('div', () => [\n                            el('button', () => [\n                                at('type', 'button'),\n                                on('click', this.#closeDatePicker),\n                                tx('Cancel'),\n                            ]),\n                            el('button', () => [\n                                at('type', 'submit'),\n                                tx('Apply'),\n                            ]),\n                        ]),\n                    ]),\n                ]),\n            ]),\n        ]));\n    }\n}\n//# sourceMappingURL=date-picker-dialog.js.map","// @ts-check\nimport { DatePickerDialogElement } from '../elements/date-picker-dialog.js';\ncustomElements.define('f-date-picker-dialog', DatePickerDialogElement);\n//# sourceMappingURL=f-date-picker-dialog.js.map"],"names":["CalendarViewChangeEvent","CustomEvent","EVENT_TYPE","constructor","options","super","DateRelatedEvent","beginDate","endDate","type","dateRange","detail","this","SelectedDateChangeEvent","SelectedDateSetEvent","SelectionModeSetEvent","selectionMode","YearMonthViewChangeEvent","year","monthIndex","monthLabel","dateToString","date","isInvalidDate","toISOString","split","anyDate","Date","isNaN","getTime","dateToNumber","dateString","parseInt","replace","dateStringToDate","yearStr","monthStr","rawDateStr","dateStr","month","el","tagNameOrElement","propFn","element","document","createElement","props","prop","Attr","setAttributeNode","Node","appendChild","text","createTextNode","at","localName","value","attr","createAttribute","tx","data","on","listener","bypassTypingListener","addEventListener","ContextAwareElement","HTMLElement","requireContext","checkingInterval","Promise","resolve","setTimeout","context","traceContext","retryThreshold","numOfRetries","interval","setInterval","clearInterval","Error","name","ShadowRoot","host","parentNode","PickedDateSetEvent","DatePickerControlElement","formAssociated","static","TIME_UNIT_DAY","SELECTION_MODE_SINGLE","SELECTION_MODE_RANGE","internals","attachInternals","timeUnit","connectedCallback","hasAttribute","getAttribute","AVAILABLE_TIME_UNITS","includes","console","warn","AVAILABLE_SELECTION_MODES","dateFormatter","setFormValue","removeAttribute","dispatchEvent","dateParserFn","beginDateStr","endDateStr","Infinity","isInvalidBeginDate","isInvalidEndDate","beginDateValue","endDateValue","form","attributes","getNamedItem","nodeValue","validity","validationMessage","willValidate","checkValidity","reportValidity","_a","DatePickerViewElement","style","CSSStyleSheet","observedAttributes","shadowRoot","attachShadow","mode","idSufix","ID_INC","calendarTbody","yearInput","monthSelect","yearMonthControlsSlot","minYear","maxYear","yearView","monthIndexView","selectedBeginDate","selectedEndDate","isDateDisabled","adoptedStyleSheets","STYLES","render","controlCtx","viewCtx","handleSelectedDateSet","handleSelectionModeSet","handleCalendarViewChange","defaultDate","setYearMonthView","getUTCFullYear","getUTCMonth","disconnectedCallback","removeEventListener","monthNames","formatter","Intl","DateTimeFormat","locale","Array","keys","map","format","dayShortNames","weekday","dayIndexes","firstDayOfWeekDate","setUTCDate","getUTCDate","getUTCDay","dayIndex","setSelectedBeginDate","patchRangeSelection","setSelectedEndDate","setDisabledFilter","filterFn","selectedIndex","toString","event","newCalendar","renderCalendar","replaceWith","datesByWeekView","beginOfMonthDate","beginOfWeekOfMonthDate","endOfMonthDate","endOfWeekOfMonthDate","weeksView","dates","isCurrMonth","isPrevMonth","isNextMonth","isToday","isWeekend","isDisabled","slice","selectedDateIsoString","length","latestWeek","dateDayIndex","dateMonthIndex","yearViewDiff","push","numericDate","id","lang","viewPrevMonth","prevMonthIndex","viewNextMonth","nextMonthIndex","handleDateSelect","preventDefault","monthName","index","setCustomValidity","slot","innerHTML","dayShortName","week","join","error","padStart","HTMLTableSectionElement","beginNumericDate","endNumericDate","isSingleSelect","treeWalker","createTreeWalker","NodeFilter","SHOW_ELEMENT","acceptNode","node","HTMLInputElement","FILTER_ACCEPT","FILTER_SKIP","input","currentNode","nextNode","label","labels","item","HTMLLabelElement","classList","remove","isFirst","isLast","checked","setAttribute","add","customElements","define","DatePickerInlineElement","attributeChangedCallback","oldValue","newValue","DatePickerMonthViewElement","handleMonthViewChange","DatePickerYearViewElement","requiredContexts","handleChange","PickedDateChangeEvent","DatePickerDialogElement","buttonText","dialog","handlePickedDateChange","handlePickedDateSet","handleSelectedDateChange","handleDialogOpen","handleDialogClose","openDatePicker","closeDatePicker","updateButtonText","requestSubmit","Text","async","HTMLDialogElement","showModal","close","handleFormSubmit","dateRangeToString"],"mappings":"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"}